<html>
<head>
<title>tester.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #606366; font-weight: normal; font-style: normal; }
.s0 { color: rgb(204,120,50); }
.s1 { color: rgb(169,183,198); }
.s2 { color: rgb(106,135,89); }
</style>
</head>
<BODY BGCOLOR="#2b2b2b">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
tester.py</FONT>
</center></TD></TR></TABLE>
<pre>
<a name="l1"><span class="ln">1    </span></a><span class="s0">import </span><span class="s1">json 
<a name="l2"><span class="ln">2    </span></a></span><span class="s0">import </span><span class="s1">os 
<a name="l3"><span class="ln">3    </span></a></span><span class="s0">import </span><span class="s1">sqlite3 
<a name="l4"><span class="ln">4    </span></a></span><span class="s0">import </span><span class="s1">time 
<a name="l5"><span class="ln">5    </span></a>t0=time.time() 
<a name="l6"><span class="ln">6    </span></a> 
<a name="l7"><span class="ln">7    </span></a>db = sqlite3.connect(</span><span class="s2">'data/thdb'</span><span class="s1">) 
<a name="l8"><span class="ln">8    </span></a>cursor = db.cursor() 
<a name="l9"><span class="ln">9    </span></a> 
<a name="l10"><span class="ln">10   </span></a>cursor.execute(</span><span class="s2">'''CREATE TABLE IF NOT EXISTS tweetsTest(id INTEGER PRIMARY KEY, tid INT, tweet TEXT, tweetNP TEXT, tweetNPSW TEXT, class TEXT)'''</span><span class="s1">) 
<a name="l11"><span class="ln">11   </span></a> 
<a name="l12"><span class="ln">12   </span></a>db.commit() 
<a name="l13"><span class="ln">13   </span></a> 
<a name="l14"><span class="ln">14   </span></a>punc = </span><span class="s2">'!&quot;#$%&amp;</span><span class="s0">\'</span><span class="s2">()*+,-./:;&lt;=&gt;?@[</span><span class="s0">\\</span><span class="s2">]^_`{|}~’…—'</span><span class="s1"> 
<a name="l15"><span class="ln">15   </span></a>stopWordsNoP = [</span><span class="s2">&quot;rt&quot;</span><span class="s0">,</span><span class="s2">&quot;a&quot;</span><span class="s0">,</span><span class="s2">&quot;about&quot;</span><span class="s0">,</span><span class="s2">&quot;above&quot;</span><span class="s0">,</span><span class="s2">&quot;after&quot;</span><span class="s0">,</span><span class="s2">&quot;again&quot;</span><span class="s0">,</span><span class="s2">&quot;against&quot;</span><span class="s0">,</span><span class="s2">&quot;all&quot;</span><span class="s0">,</span><span class="s2">&quot;am&quot;</span><span class="s0">,</span><span class="s2">&quot;an&quot;</span><span class="s0">,</span><span class="s2">&quot;and&quot;</span><span class="s0">,</span><span class="s2">&quot;any&quot;</span><span class="s0">,</span><span class="s2">&quot;are&quot;</span><span class="s0">,</span><span class="s2">&quot;arent&quot;</span><span class="s0">,</span><span class="s2">&quot;as&quot;</span><span class="s0">,</span><span class="s2">&quot;at&quot;</span><span class="s0">,</span><span class="s2">&quot;be&quot;</span><span class="s0">,</span><span class="s2">&quot;because&quot;</span><span class="s0">,</span><span class="s2">&quot;been&quot;</span><span class="s0">,</span><span class="s2">&quot;before&quot;</span><span class="s0">,</span><span class="s2">&quot;being&quot;</span><span class="s0">,</span><span class="s2">&quot;below&quot;</span><span class="s0">,</span><span class="s2">&quot;between&quot;</span><span class="s0">,</span><span class="s2">&quot;both&quot;</span><span class="s0">,</span><span class="s2">&quot;but&quot;</span><span class="s0">,</span><span class="s2">&quot;by&quot;</span><span class="s0">,</span><span class="s2">&quot;cant&quot;</span><span class="s0">,</span><span class="s2">&quot;cannot&quot;</span><span class="s0">,</span><span class="s2">&quot;could&quot;</span><span class="s0">,</span><span class="s2">&quot;couldnt&quot;</span><span class="s0">,</span><span class="s2">&quot;did&quot;</span><span class="s0">,</span><span class="s2">&quot;didnt&quot;</span><span class="s0">,</span><span class="s2">&quot;do&quot;</span><span class="s0">,</span><span class="s2">&quot;does&quot;</span><span class="s0">,</span><span class="s2">&quot;doesnt&quot;</span><span class="s0">,</span><span class="s2">&quot;doing&quot;</span><span class="s0">,</span><span class="s2">&quot;dont&quot;</span><span class="s0">,</span><span class="s2">&quot;down&quot;</span><span class="s0">,</span><span class="s2">&quot;during&quot;</span><span class="s0">,</span><span class="s2">&quot;each&quot;</span><span class="s0">,</span><span class="s2">&quot;few&quot;</span><span class="s0">,</span><span class="s2">&quot;for&quot;</span><span class="s0">,</span><span class="s2">&quot;from&quot;</span><span class="s0">,</span><span class="s2">&quot;further&quot;</span><span class="s0">,</span><span class="s2">&quot;had&quot;</span><span class="s0">,</span><span class="s2">&quot;hadnt&quot;</span><span class="s0">,</span><span class="s2">&quot;has&quot;</span><span class="s0">,</span><span class="s2">&quot;hasnt&quot;</span><span class="s0">,</span><span class="s2">&quot;have&quot;</span><span class="s0">,</span><span class="s2">&quot;havent&quot;</span><span class="s0">,</span><span class="s2">&quot;having&quot;</span><span class="s0">,</span><span class="s2">&quot;he&quot;</span><span class="s0">,</span><span class="s2">&quot;hed&quot;</span><span class="s0">,</span><span class="s2">&quot;hell&quot;</span><span class="s0">,</span><span class="s2">&quot;hes&quot;</span><span class="s0">,</span><span class="s2">&quot;her&quot;</span><span class="s0">,</span><span class="s2">&quot;here&quot;</span><span class="s0">,</span><span class="s2">&quot;heres&quot;</span><span class="s0">,</span><span class="s2">&quot;hers&quot;</span><span class="s0">,</span><span class="s2">&quot;herself&quot;</span><span class="s0">,</span><span class="s2">&quot;him&quot;</span><span class="s0">,</span><span class="s2">&quot;himself&quot;</span><span class="s0">,</span><span class="s2">&quot;his&quot;</span><span class="s0">,</span><span class="s2">&quot;how&quot;</span><span class="s0">,</span><span class="s2">&quot;hows&quot;</span><span class="s0">,</span><span class="s2">&quot;i&quot;</span><span class="s0">,</span><span class="s2">&quot;id&quot;</span><span class="s0">,</span><span class="s2">&quot;ill&quot;</span><span class="s0">,</span><span class="s2">&quot;im&quot;</span><span class="s0">,</span><span class="s2">&quot;ive&quot;</span><span class="s0">,</span><span class="s2">&quot;if&quot;</span><span class="s0">,</span><span class="s2">&quot;in&quot;</span><span class="s0">,</span><span class="s2">&quot;into&quot;</span><span class="s0">,</span><span class="s2">&quot;is&quot;</span><span class="s0">,</span><span class="s2">&quot;isnt&quot;</span><span class="s0">,</span><span class="s2">&quot;it&quot;</span><span class="s0">,</span><span class="s2">&quot;its&quot;</span><span class="s0">,</span><span class="s2">&quot;its&quot;</span><span class="s0">,</span><span class="s2">&quot;itself&quot;</span><span class="s0">,</span><span class="s2">&quot;lets&quot;</span><span class="s0">,</span><span class="s2">&quot;me&quot;</span><span class="s0">,</span><span class="s2">&quot;more&quot;</span><span class="s0">,</span><span class="s2">&quot;most&quot;</span><span class="s0">,</span><span class="s2">&quot;mustnt&quot;</span><span class="s0">,</span><span class="s2">&quot;my&quot;</span><span class="s0">,</span><span class="s2">&quot;myself&quot;</span><span class="s0">,</span><span class="s2">&quot;no&quot;</span><span class="s0">,</span><span class="s2">&quot;nor&quot;</span><span class="s0">,</span><span class="s2">&quot;not&quot;</span><span class="s0">,</span><span class="s2">&quot;of&quot;</span><span class="s0">,</span><span class="s2">&quot;off&quot;</span><span class="s0">,</span><span class="s2">&quot;on&quot;</span><span class="s0">,</span><span class="s2">&quot;once&quot;</span><span class="s0">,</span><span class="s2">&quot;only&quot;</span><span class="s0">,</span><span class="s2">&quot;or&quot;</span><span class="s0">,</span><span class="s2">&quot;other&quot;</span><span class="s0">,</span><span class="s2">&quot;ought&quot;</span><span class="s0">,</span><span class="s2">&quot;our&quot;</span><span class="s0">,</span><span class="s2">&quot;ours&quot;</span><span class="s0">,</span><span class="s2">&quot;ourselves&quot;</span><span class="s0">,</span><span class="s2">&quot;out&quot;</span><span class="s0">,</span><span class="s2">&quot;over&quot;</span><span class="s0">,</span><span class="s2">&quot;own&quot;</span><span class="s0">,</span><span class="s2">&quot;same&quot;</span><span class="s0">,</span><span class="s2">&quot;shant&quot;</span><span class="s0">,</span><span class="s2">&quot;she&quot;</span><span class="s0">,</span><span class="s2">&quot;shed&quot;</span><span class="s0">,</span><span class="s2">&quot;shell&quot;</span><span class="s0">,</span><span class="s2">&quot;shes&quot;</span><span class="s0">,</span><span class="s2">&quot;should&quot;</span><span class="s0">,</span><span class="s2">&quot;shouldnt&quot;</span><span class="s0">,</span><span class="s2">&quot;so&quot;</span><span class="s0">,</span><span class="s2">&quot;some&quot;</span><span class="s0">,</span><span class="s2">&quot;such&quot;</span><span class="s0">,</span><span class="s2">&quot;than&quot;</span><span class="s0">,</span><span class="s2">&quot;that&quot;</span><span class="s0">,</span><span class="s2">&quot;thats&quot;</span><span class="s0">,</span><span class="s2">&quot;the&quot;</span><span class="s0">,</span><span class="s2">&quot;their&quot;</span><span class="s0">,</span><span class="s2">&quot;theirs&quot;</span><span class="s0">,</span><span class="s2">&quot;them&quot;</span><span class="s0">,</span><span class="s2">&quot;themselves&quot;</span><span class="s0">,</span><span class="s2">&quot;then&quot;</span><span class="s0">,</span><span class="s2">&quot;there&quot;</span><span class="s0">,</span><span class="s2">&quot;theres&quot;</span><span class="s0">,</span><span class="s2">&quot;these&quot;</span><span class="s0">,</span><span class="s2">&quot;they&quot;</span><span class="s0">,</span><span class="s2">&quot;theyd&quot;</span><span class="s0">,</span><span class="s2">&quot;theyll&quot;</span><span class="s0">,</span><span class="s2">&quot;theyre&quot;</span><span class="s0">,</span><span class="s2">&quot;theyve&quot;</span><span class="s0">,</span><span class="s2">&quot;this&quot;</span><span class="s0">,</span><span class="s2">&quot;those&quot;</span><span class="s0">,</span><span class="s2">&quot;through&quot;</span><span class="s0">,</span><span class="s2">&quot;to&quot;</span><span class="s0">,</span><span class="s2">&quot;too&quot;</span><span class="s0">,</span><span class="s2">&quot;under&quot;</span><span class="s0">,</span><span class="s2">&quot;until&quot;</span><span class="s0">,</span><span class="s2">&quot;up&quot;</span><span class="s0">,</span><span class="s2">&quot;very&quot;</span><span class="s0">,</span><span class="s2">&quot;was&quot;</span><span class="s0">,</span><span class="s2">&quot;wasnt&quot;</span><span class="s0">,</span><span class="s2">&quot;we&quot;</span><span class="s0">,</span><span class="s2">&quot;wed&quot;</span><span class="s0">,</span><span class="s2">&quot;well&quot;</span><span class="s0">,</span><span class="s2">&quot;were&quot;</span><span class="s0">,</span><span class="s2">&quot;weve&quot;</span><span class="s0">,</span><span class="s2">&quot;were&quot;</span><span class="s0">,</span><span class="s2">&quot;werent&quot;</span><span class="s0">,</span><span class="s2">&quot;what&quot;</span><span class="s0">,</span><span class="s2">&quot;whats&quot;</span><span class="s0">,</span><span class="s2">&quot;when&quot;</span><span class="s0">,</span><span class="s2">&quot;whens&quot;</span><span class="s0">,</span><span class="s2">&quot;where&quot;</span><span class="s0">,</span><span class="s2">&quot;wheres&quot;</span><span class="s0">,</span><span class="s2">&quot;which&quot;</span><span class="s0">,</span><span class="s2">&quot;while&quot;</span><span class="s0">,</span><span class="s2">&quot;who&quot;</span><span class="s0">,</span><span class="s2">&quot;whos&quot;</span><span class="s0">,</span><span class="s2">&quot;whom&quot;</span><span class="s0">,</span><span class="s2">&quot;why&quot;</span><span class="s0">,</span><span class="s2">&quot;whys&quot;</span><span class="s0">,</span><span class="s2">&quot;with&quot;</span><span class="s0">,</span><span class="s2">&quot;wont&quot;</span><span class="s0">,</span><span class="s2">&quot;would&quot;</span><span class="s0">,</span><span class="s2">&quot;wouldnt&quot;</span><span class="s0">,</span><span class="s2">&quot;you&quot;</span><span class="s0">,</span><span class="s2">&quot;youd&quot;</span><span class="s0">,</span><span class="s2">&quot;youll&quot;</span><span class="s0">,</span><span class="s2">&quot;youre&quot;</span><span class="s0">,</span><span class="s2">&quot;youve&quot;</span><span class="s0">,</span><span class="s2">&quot;your&quot;</span><span class="s0">,</span><span class="s2">&quot;yours&quot;</span><span class="s0">,</span><span class="s2">&quot;yourself&quot;</span><span class="s0">,</span><span class="s2">&quot;yourselves&quot;</span><span class="s1">] 
<a name="l16"><span class="ln">16   </span></a> 
<a name="l17"><span class="ln">17   </span></a></span><span class="s0">def </span><span class="s1">stopWordRemover (text</span><span class="s0">, </span><span class="s1">swords): 
<a name="l18"><span class="ln">18   </span></a>    </span><span class="s0">return </span><span class="s1">list(set([word </span><span class="s0">for </span><span class="s1">word </span><span class="s0">in </span><span class="s1">text.split() </span><span class="s0">if </span><span class="s1">word.lower() </span><span class="s0">not in </span><span class="s1">swords])) 
<a name="l19"><span class="ln">19   </span></a> 
<a name="l20"><span class="ln">20   </span></a></span><span class="s0">def </span><span class="s1">linkRemover (text): 
<a name="l21"><span class="ln">21   </span></a>    </span><span class="s0">return </span><span class="s1">list(set([word </span><span class="s0">for </span><span class="s1">word </span><span class="s0">in </span><span class="s1">text.split() </span><span class="s0">if not </span><span class="s1">(word.lower().startswith(</span><span class="s2">'www.'</span><span class="s1">) </span><span class="s0">or </span><span class="s1">word.lower().startswith(</span><span class="s2">'http'</span><span class="s1">))])) 
<a name="l22"><span class="ln">22   </span></a> 
<a name="l23"><span class="ln">23   </span></a></span><span class="s0">for </span><span class="s1">jsonFilename </span><span class="s0">in </span><span class="s1">os.listdir(</span><span class="s2">'dumpKaggleTest'</span><span class="s1">): 
<a name="l24"><span class="ln">24   </span></a>    </span><span class="s0">with </span><span class="s1">open(</span><span class="s2">&quot;dumpKaggleTest</span><span class="s0">\\</span><span class="s2">&quot;</span><span class="s1">+jsonFilename) </span><span class="s0">as </span><span class="s1">json_file: 
<a name="l25"><span class="ln">25   </span></a>        data = json.load(json_file) 
<a name="l26"><span class="ln">26   </span></a>        tid = data[</span><span class="s2">&quot;id&quot;</span><span class="s1">] 
<a name="l27"><span class="ln">27   </span></a>        classOf = data[</span><span class="s2">&quot;handle&quot;</span><span class="s1">] 
<a name="l28"><span class="ln">28   </span></a>        tweet = data[</span><span class="s2">&quot;text&quot;</span><span class="s1">].lower() 
<a name="l29"><span class="ln">29   </span></a>        tweetNP = tweet.translate(str.maketrans(</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">punc)) 
<a name="l30"><span class="ln">30   </span></a>        tweetNPSW = </span><span class="s2">' '</span><span class="s1">.join(stopWordRemover(tweetNP</span><span class="s0">, </span><span class="s1">stopWordsNoP)) 
<a name="l31"><span class="ln">31   </span></a>        tweetNPSW = </span><span class="s2">' '</span><span class="s1">.join(linkRemover(tweetNPSW)) 
<a name="l32"><span class="ln">32   </span></a> 
<a name="l33"><span class="ln">33   </span></a>        cursor.execute(</span><span class="s2">'''INSERT INTO tweetsTest(tid, tweet, tweetNP, tweetNPSW, class) VALUES(?,?,?,?,?)'''</span><span class="s0">,</span><span class="s1"> 
<a name="l34"><span class="ln">34   </span></a>                       (tid</span><span class="s0">, </span><span class="s1">tweet</span><span class="s0">, </span><span class="s1">tweetNP</span><span class="s0">, </span><span class="s1">tweetNPSW</span><span class="s0">, </span><span class="s1">classOf)) 
<a name="l35"><span class="ln">35   </span></a>db.commit() 
<a name="l36"><span class="ln">36   </span></a>db.close() 
<a name="l37"><span class="ln">37   </span></a>t1 = time.time() 
<a name="l38"><span class="ln">38   </span></a>print(</span><span class="s2">&quot;Total time: &quot;</span><span class="s1">+str(t1-t0)) 
<a name="l39"><span class="ln">39   </span></a>print(</span><span class="s2">&quot;Test finished&quot;</span><span class="s1">)</span></pre>
</body>
</html>